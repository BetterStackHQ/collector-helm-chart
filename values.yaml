# Default values for better-stack-collector
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Collector configuration
collector:
  image:
    repository: ghcr.io/betterstackhq/collector
    tag: latest
    pullPolicy: Always

  # Environment variables
  env:
    COLLECTOR_SECRET: ""  # Required: Your collector secret (leave empty if using envFrom)
    BASE_URL: "https://telemetry.betterstack.com"
    CLUSTER_COLLECTOR: ""
    VECTOR_LOG_FORMAT: "json"

  # Environment variables from ConfigMaps and Secrets (standard Kubernetes envFrom format)
  # Example:
  #   envFrom:
  #     - secretRef:
  #         name: collector-secrets
  #     - configMapRef:
  #         name: collector-config
  envFrom: []

  # Resource limits and requests
  resources:
    limits:
      cpu: 1200m
      memory: 1Gi
    requests:
      cpu: 800m
      memory: 1Gi

  # Node selector
  nodeSelector: {}

  # Tolerations
  tolerations: []

  # Affinity
  affinity: {}

  # Host filesystem mount configuration
  # By default, mounts the entire host root filesystem at /host (read-only)
  # You can specify specific paths to mount instead. Each path will be mounted
  # under /host with the same path structure (e.g., /var/www -> /host/var/www)
  hostMounts:
    # Array of host paths to mount. If empty, mounts root filesystem
    # Example: ["/var/www/custom", "/var/lib/something"]
    paths: []

# eBPF tracing configuration
# Note: 'ebpf' is the preferred key. 'beyla' is deprecated but still supported.
# If both are specified, 'ebpf' takes precedence.
#
# ebpf:
#   enabled: true
#   image:
#     repository: ghcr.io/betterstackhq/collector-ebpf
#     tag: latest
#     pullPolicy: Always
#   env:
#     GOMEMLIMIT: 1400MiB
#   envFrom: []
#   dockerprobe:
#     enabled: false
#   resources:
#     limits:
#       cpu: 1000m
#       memory: 3000Mi
#     requests:
#       cpu: 800m
#       memory: 1000Mi
#   memoryRestartThreshold: 1450

# DEPRECATED: Use 'ebpf' instead. This key will be removed in a future release.
beyla:
  enabled: true

  image:
    repository: ghcr.io/betterstackhq/collector-ebpf
    tag: latest
    pullPolicy: Always

  env:
    GOMEMLIMIT: 1400MiB

  # Example:
  #   envFrom:
  #     - secretRef:
  #         name: ebpf-secrets
  envFrom: []

  dockerprobe:
    enabled: false

  resources:
    limits:
      cpu: 1000m
      memory: 3000Mi
    requests:
      cpu: 800m
      memory: 1000Mi

  memoryRestartThreshold: 1450

# RBAC configuration
rbac:
  # Create service account
  create: true
  # Service account name
  serviceAccountName: better-stack-collector

# Security context for pods
securityContext:
  collector:
    runAsNonRoot: false
    runAsUser: 0
    fsGroup: 0

  # For eBPF container (requires privileged access)
  # Note: 'ebpf' is preferred. 'beyla' is deprecated but still supported.
  # ebpf:
  #   privileged: true

  # DEPRECATED: Use 'securityContext.ebpf' instead
  beyla:
    privileged: true

# Image pull secrets
imagePullSecrets: []

# Global labels to add to all resources
commonLabels: {}

# Global annotations to add to all resources
commonAnnotations: {}

# Priority class (optional)
# priorityClassName: ""

